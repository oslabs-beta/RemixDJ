{"version":3,"file":"index.js","sources":["../node_modules/tslib/tslib.es6.js","../compiled/parse/lexicalAnalysis.js","../compiled/parse/simplifyAST.js","../compiled/parse/syntacticAnalysis.js"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __createBinding(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","import { __read } from \"tslib\";\nvar weirdNewlines = /(\\u000D|\\u000C|\\u000D\\u000A)/g;\nvar nullOrSurrogates = /[\\u0000\\uD800-\\uDFFF]/g;\nvar commentRegex = /(\\/\\*)[\\s\\S]*?(\\*\\/)/g;\nexport var lexicalAnalysis = function (str, index) {\n    if (index === void 0) { index = 0; }\n    str = str.replace(weirdNewlines, '\\n').replace(nullOrSurrogates, '\\uFFFD');\n    str = str.replace(commentRegex, '');\n    var tokens = [];\n    for (; index < str.length; index += 1) {\n        var code = str.charCodeAt(index);\n        if (code === 0x0009 || code === 0x0020 || code === 0x000a) {\n            var code_1 = str.charCodeAt(++index);\n            while (code_1 === 0x0009 || code_1 === 0x0020 || code_1 === 0x000a) {\n                code_1 = str.charCodeAt(++index);\n            }\n            index -= 1;\n            tokens.push({\n                type: '<whitespace-token>'\n            });\n        }\n        else if (code === 0x0022) {\n            var result = consumeString(str, index);\n            if (result === null) {\n                return null;\n            }\n            var _a = __read(result, 2), lastIndex = _a[0], value = _a[1];\n            tokens.push({\n                type: '<string-token>',\n                value: value\n            });\n            index = lastIndex;\n        }\n        else if (code === 0x0023) {\n            if (index + 1 < str.length) {\n                var nextCode = str.charCodeAt(index + 1);\n                if (nextCode === 0x005f ||\n                    (nextCode >= 0x0041 && nextCode <= 0x005a) ||\n                    (nextCode >= 0x0061 && nextCode <= 0x007a) ||\n                    nextCode >= 0x0080 ||\n                    (nextCode >= 0x0030 && nextCode <= 0x0039) ||\n                    (nextCode === 0x005c &&\n                        index + 2 < str.length &&\n                        str.charCodeAt(index + 2) !== 0x000a)) {\n                    var flag = wouldStartIdentifier(str, index + 1)\n                        ? 'id'\n                        : 'unrestricted';\n                    var result = consumeIdentUnsafe(str, index + 1);\n                    if (result !== null) {\n                        var _b = __read(result, 2), lastIndex = _b[0], value = _b[1];\n                        tokens.push({\n                            type: '<hash-token>',\n                            value: value.toLowerCase(),\n                            flag: flag\n                        });\n                        index = lastIndex;\n                        continue;\n                    }\n                }\n            }\n            tokens.push({ type: '<delim-token>', value: code });\n        }\n        else if (code === 0x0027) {\n            var result = consumeString(str, index);\n            if (result === null) {\n                return null;\n            }\n            var _c = __read(result, 2), lastIndex = _c[0], value = _c[1];\n            tokens.push({\n                type: '<string-token>',\n                value: value\n            });\n            index = lastIndex;\n        }\n        else if (code === 0x0028) {\n            tokens.push({ type: '<(-token>' });\n        }\n        else if (code === 0x0029) {\n            tokens.push({ type: '<)-token>' });\n        }\n        else if (code === 0x002b) {\n            var plusNumeric = consumeNumeric(str, index);\n            if (plusNumeric === null) {\n                tokens.push({\n                    type: '<delim-token>',\n                    value: code\n                });\n            }\n            else {\n                var _d = __read(plusNumeric, 2), lastIndex = _d[0], tokenTuple = _d[1];\n                if (tokenTuple[0] === '<dimension-token>') {\n                    tokens.push({\n                        type: '<dimension-token>',\n                        value: tokenTuple[1],\n                        unit: tokenTuple[2].toLowerCase(),\n                        flag: 'number'\n                    });\n                }\n                else if (tokenTuple[0] === '<number-token>') {\n                    tokens.push({\n                        type: tokenTuple[0],\n                        value: tokenTuple[1],\n                        flag: tokenTuple[2]\n                    });\n                }\n                else {\n                    tokens.push({\n                        type: tokenTuple[0],\n                        value: tokenTuple[1],\n                        flag: 'number'\n                    });\n                }\n                index = lastIndex;\n            }\n        }\n        else if (code === 0x002c) {\n            tokens.push({ type: '<comma-token>' });\n        }\n        else if (code === 0x002d) {\n            var minusNumeric = consumeNumeric(str, index);\n            if (minusNumeric !== null) {\n                var _e = __read(minusNumeric, 2), lastIndex = _e[0], tokenTuple = _e[1];\n                if (tokenTuple[0] === '<dimension-token>') {\n                    tokens.push({\n                        type: '<dimension-token>',\n                        value: tokenTuple[1],\n                        unit: tokenTuple[2].toLowerCase(),\n                        flag: 'number'\n                    });\n                }\n                else if (tokenTuple[0] === '<number-token>') {\n                    tokens.push({\n                        type: tokenTuple[0],\n                        value: tokenTuple[1],\n                        flag: tokenTuple[2]\n                    });\n                }\n                else {\n                    tokens.push({\n                        type: tokenTuple[0],\n                        value: tokenTuple[1],\n                        flag: 'number'\n                    });\n                }\n                index = lastIndex;\n                continue;\n            }\n            if (index + 2 < str.length) {\n                var nextCode = str.charCodeAt(index + 1);\n                var nextNextCode = str.charCodeAt(index + 2);\n                if (nextCode === 0x002d && nextNextCode === 0x003e) {\n                    tokens.push({\n                        type: '<CDC-token>'\n                    });\n                    index += 2;\n                    continue;\n                }\n            }\n            var result = consumeIdentLike(str, index);\n            if (result !== null) {\n                var _f = __read(result, 3), lastIndex = _f[0], value = _f[1], type = _f[2];\n                tokens.push({\n                    type: type,\n                    value: value\n                });\n                index = lastIndex;\n                continue;\n            }\n            tokens.push({\n                type: '<delim-token>',\n                value: code\n            });\n        }\n        else if (code === 0x002e) {\n            var minusNumeric = consumeNumeric(str, index);\n            if (minusNumeric === null) {\n                tokens.push({\n                    type: '<delim-token>',\n                    value: code\n                });\n            }\n            else {\n                var _g = __read(minusNumeric, 2), lastIndex = _g[0], tokenTuple = _g[1];\n                if (tokenTuple[0] === '<dimension-token>') {\n                    tokens.push({\n                        type: '<dimension-token>',\n                        value: tokenTuple[1],\n                        unit: tokenTuple[2].toLowerCase(),\n                        flag: 'number'\n                    });\n                }\n                else if (tokenTuple[0] === '<number-token>') {\n                    tokens.push({\n                        type: tokenTuple[0],\n                        value: tokenTuple[1],\n                        flag: tokenTuple[2]\n                    });\n                }\n                else {\n                    tokens.push({\n                        type: tokenTuple[0],\n                        value: tokenTuple[1],\n                        flag: 'number'\n                    });\n                }\n                index = lastIndex;\n                continue;\n            }\n        }\n        else if (code === 0x003a) {\n            tokens.push({ type: '<colon-token>' });\n        }\n        else if (code === 0x003b) {\n            tokens.push({ type: '<semicolon-token>' });\n        }\n        else if (code === 0x003c) {\n            if (index + 3 < str.length) {\n                var nextCode = str.charCodeAt(index + 1);\n                var nextNextCode = str.charCodeAt(index + 2);\n                var nextNextNextCode = str.charCodeAt(index + 3);\n                if (nextCode === 0x0021 &&\n                    nextNextCode === 0x002d &&\n                    nextNextNextCode === 0x002d) {\n                    tokens.push({\n                        type: '<CDO-token>'\n                    });\n                    index += 3;\n                    continue;\n                }\n            }\n            tokens.push({\n                type: '<delim-token>',\n                value: code\n            });\n        }\n        else if (code === 0x0040) {\n            var result = consumeIdent(str, index + 1);\n            if (result !== null) {\n                var _h = __read(result, 2), lastIndex = _h[0], value = _h[1];\n                tokens.push({\n                    type: '<at-keyword-token>',\n                    value: value.toLowerCase()\n                });\n                index = lastIndex;\n                continue;\n            }\n            tokens.push({ type: '<delim-token>', value: code });\n        }\n        else if (code === 0x005b) {\n            tokens.push({ type: '<[-token>' });\n        }\n        else if (code === 0x005c) {\n            var result = consumeEscape(str, index);\n            if (result === null) {\n                return null;\n            }\n            var _j = __read(result, 2), lastIndex = _j[0], value = _j[1];\n            str = str.slice(0, index) + value + str.slice(lastIndex + 1);\n            index -= 1;\n        }\n        else if (code === 0x005d) {\n            tokens.push({ type: '<]-token>' });\n        }\n        else if (code === 0x007b) {\n            tokens.push({ type: '<{-token>' });\n        }\n        else if (code === 0x007d) {\n            tokens.push({ type: '<}-token>' });\n        }\n        else if (code >= 0x0030 && code <= 0x0039) {\n            var result = consumeNumeric(str, index);\n            var _k = __read(result, 2), lastIndex = _k[0], tokenTuple = _k[1];\n            if (tokenTuple[0] === '<dimension-token>') {\n                tokens.push({\n                    type: '<dimension-token>',\n                    value: tokenTuple[1],\n                    unit: tokenTuple[2].toLowerCase(),\n                    flag: 'number'\n                });\n            }\n            else if (tokenTuple[0] === '<number-token>') {\n                tokens.push({\n                    type: tokenTuple[0],\n                    value: tokenTuple[1],\n                    flag: tokenTuple[2]\n                });\n            }\n            else {\n                tokens.push({\n                    type: tokenTuple[0],\n                    value: tokenTuple[1],\n                    flag: 'number'\n                });\n            }\n            index = lastIndex;\n        }\n        else if (code === 0x005f ||\n            (code >= 0x0041 && code <= 0x005a) ||\n            (code >= 0x0061 && code <= 0x007a) ||\n            code >= 0x0080) {\n            var result = consumeIdentLike(str, index);\n            if (result === null) {\n                return null;\n            }\n            var _l = __read(result, 3), lastIndex = _l[0], value = _l[1], type = _l[2];\n            tokens.push({\n                type: type,\n                value: value\n            });\n            index = lastIndex;\n        }\n        else {\n            tokens.push({ type: '<delim-token>', value: code });\n        }\n    }\n    tokens.push({ type: '<EOF-token>' });\n    return tokens;\n};\nexport var consumeString = function (str, index) {\n    if (str.length <= index + 1)\n        return null;\n    var firstCode = str.charCodeAt(index);\n    var charCodes = [];\n    for (var i = index + 1; i < str.length; i += 1) {\n        var code = str.charCodeAt(i);\n        if (code === firstCode) {\n            return [i, String.fromCharCode.apply(null, charCodes)];\n        }\n        else if (code === 0x005c) {\n            var result = consumeEscape(str, i);\n            if (result === null)\n                return null;\n            var _a = __read(result, 2), lastIndex = _a[0], charCode = _a[1];\n            charCodes.push(charCode);\n            i = lastIndex;\n        }\n        else if (code === 0x000a) {\n            return null;\n        }\n        else {\n            charCodes.push(code);\n        }\n    }\n    return null;\n};\nexport var wouldStartIdentifier = function (str, index) {\n    if (str.length <= index)\n        return false;\n    var code = str.charCodeAt(index);\n    if (code === 0x002d) {\n        if (str.length <= index + 1)\n            return false;\n        var nextCode = str.charCodeAt(index + 1);\n        if (nextCode === 0x002d ||\n            nextCode === 0x005f ||\n            (nextCode >= 0x0041 && nextCode <= 0x005a) ||\n            (nextCode >= 0x0061 && nextCode <= 0x007a) ||\n            nextCode >= 0x0080) {\n            return true;\n        }\n        else if (nextCode === 0x005c) {\n            if (str.length <= index + 2)\n                return false;\n            var nextNextCode = str.charCodeAt(index + 2);\n            return nextNextCode !== 0x000a;\n        }\n        else {\n            return false;\n        }\n    }\n    else if (code === 0x005f ||\n        (code >= 0x0041 && code <= 0x005a) ||\n        (code >= 0x0061 && code <= 0x007a) ||\n        code >= 0x0080) {\n        return true;\n    }\n    else if (code === 0x005c) {\n        if (str.length <= index + 1)\n            return false;\n        var nextCode = str.charCodeAt(index + 1);\n        return nextCode !== 0x000a;\n    }\n    else {\n        return false;\n    }\n};\nexport var consumeEscape = function (str, index) {\n    if (str.length <= index + 1)\n        return null;\n    if (str.charCodeAt(index) !== 0x005c)\n        return null;\n    var code = str.charCodeAt(index + 1);\n    if (code === 0x000a) {\n        return null;\n    }\n    else if ((code >= 0x0030 && code <= 0x0039) ||\n        (code >= 0x0041 && code <= 0x0046) ||\n        (code >= 0x0061 && code <= 0x0066)) {\n        var hexCharCodes = [code];\n        var min = Math.min(index + 7, str.length);\n        var i = index + 2;\n        for (; i < min; i += 1) {\n            var code_2 = str.charCodeAt(i);\n            if ((code_2 >= 0x0030 && code_2 <= 0x0039) ||\n                (code_2 >= 0x0041 && code_2 <= 0x0046) ||\n                (code_2 >= 0x0061 && code_2 <= 0x0066)) {\n                hexCharCodes.push(code_2);\n            }\n            else {\n                break;\n            }\n        }\n        if (i < str.length) {\n            var code_3 = str.charCodeAt(i);\n            if (code_3 === 0x0009 || code_3 === 0x0020 || code_3 === 0x000a) {\n                i += 1;\n            }\n        }\n        return [i - 1, parseInt(String.fromCharCode.apply(null, hexCharCodes), 16)];\n    }\n    else {\n        return [index + 1, code];\n    }\n};\nexport var consumeNumeric = function (str, index) {\n    var numberResult = consumeNumber(str, index);\n    if (numberResult === null)\n        return null;\n    var _a = __read(numberResult, 3), numberEndIndex = _a[0], numberValue = _a[1], numberFlag = _a[2];\n    var identResult = consumeIdent(str, numberEndIndex + 1);\n    if (identResult !== null) {\n        var _b = __read(identResult, 2), identEndIndex = _b[0], identValue = _b[1];\n        return [identEndIndex, ['<dimension-token>', numberValue, identValue]];\n    }\n    if (numberEndIndex + 1 < str.length &&\n        str.charCodeAt(numberEndIndex + 1) === 0x0025) {\n        return [numberEndIndex + 1, ['<percentage-token>', numberValue]];\n    }\n    return [numberEndIndex, ['<number-token>', numberValue, numberFlag]];\n};\nexport var consumeNumber = function (str, index) {\n    if (str.length <= index)\n        return null;\n    var flag = 'integer';\n    var numberChars = [];\n    var firstCode = str.charCodeAt(index);\n    if (firstCode === 0x002b || firstCode === 0x002d) {\n        index += 1;\n        if (firstCode === 0x002d)\n            numberChars.push(0x002d);\n    }\n    while (index < str.length) {\n        var code = str.charCodeAt(index);\n        if (code >= 0x0030 && code <= 0x0039) {\n            numberChars.push(code);\n            index += 1;\n        }\n        else {\n            break;\n        }\n    }\n    if (index + 1 < str.length) {\n        var nextCode = str.charCodeAt(index);\n        var nextNextCode = str.charCodeAt(index + 1);\n        if (nextCode === 0x002e &&\n            nextNextCode >= 0x0030 &&\n            nextNextCode <= 0x0039) {\n            numberChars.push(nextCode, nextNextCode);\n            flag = 'number';\n            index += 2;\n            while (index < str.length) {\n                var code = str.charCodeAt(index);\n                if (code >= 0x0030 && code <= 0x0039) {\n                    numberChars.push(code);\n                    index += 1;\n                }\n                else {\n                    break;\n                }\n            }\n        }\n    }\n    if (index + 1 < str.length) {\n        var nextCode = str.charCodeAt(index);\n        var nextNextCode = str.charCodeAt(index + 1);\n        var nextNextNextCode = str.charCodeAt(index + 2);\n        if (nextCode === 0x0045 || nextCode === 0x0065) {\n            var nextNextIsDigit = nextNextCode >= 0x0030 && nextNextCode <= 0x0039;\n            if (nextNextIsDigit ||\n                ((nextNextCode === 0x002b || nextNextCode === 0x002d) &&\n                    nextNextNextCode >= 0x0030 &&\n                    nextNextNextCode <= 0x0039)) {\n                flag = 'number';\n                if (nextNextIsDigit) {\n                    numberChars.push(0x0045, nextNextCode);\n                    index += 2;\n                }\n                else if (nextNextCode === 0x002d) {\n                    numberChars.push(0x0045, 0x002d, nextNextNextCode);\n                    index += 3;\n                }\n                else {\n                    numberChars.push(0x0045, nextNextNextCode);\n                    index += 3;\n                }\n                while (index < str.length) {\n                    var code = str.charCodeAt(index);\n                    if (code >= 0x0030 && code <= 0x0039) {\n                        numberChars.push(code);\n                        index += 1;\n                    }\n                    else {\n                        break;\n                    }\n                }\n            }\n        }\n    }\n    var numberString = String.fromCharCode.apply(null, numberChars);\n    var value = flag === 'number' ? parseFloat(numberString) : parseInt(numberString);\n    if (value === -0)\n        value = 0;\n    return Number.isNaN(value) ? null : [index - 1, value, flag];\n};\nexport var consumeIdentUnsafe = function (str, index) {\n    if (str.length <= index) {\n        return null;\n    }\n    var identChars = [];\n    for (var code = str.charCodeAt(index); index < str.length; code = str.charCodeAt(++index)) {\n        if (code === 0x002d ||\n            code === 0x005f ||\n            (code >= 0x0041 && code <= 0x005a) ||\n            (code >= 0x0061 && code <= 0x007a) ||\n            code >= 0x0080 ||\n            (code >= 0x0030 && code <= 0x0039)) {\n            identChars.push(code);\n            continue;\n        }\n        else {\n            var result = consumeEscape(str, index);\n            if (result !== null) {\n                var _a = __read(result, 2), lastIndex = _a[0], code_4 = _a[1];\n                identChars.push(code_4);\n                index = lastIndex;\n                continue;\n            }\n        }\n        break;\n    }\n    return index === 0\n        ? null\n        : [index - 1, String.fromCharCode.apply(null, identChars)];\n};\nexport var consumeIdent = function (str, index) {\n    if (str.length <= index || !wouldStartIdentifier(str, index)) {\n        return null;\n    }\n    var identChars = [];\n    for (var code = str.charCodeAt(index); index < str.length; code = str.charCodeAt(++index)) {\n        if (code === 0x002d ||\n            code === 0x005f ||\n            (code >= 0x0041 && code <= 0x005a) ||\n            (code >= 0x0061 && code <= 0x007a) ||\n            code >= 0x0080 ||\n            (code >= 0x0030 && code <= 0x0039)) {\n            identChars.push(code);\n            continue;\n        }\n        else {\n            var result = consumeEscape(str, index);\n            if (result !== null) {\n                var _a = __read(result, 2), lastIndex = _a[0], code_5 = _a[1];\n                identChars.push(code_5);\n                index = lastIndex;\n                continue;\n            }\n        }\n        break;\n    }\n    return [index - 1, String.fromCharCode.apply(null, identChars)];\n};\nexport var consumeUrl = function (str, index) {\n    var code = str.charCodeAt(index);\n    while (code === 0x0009 || code === 0x0020 || code === 0x000a) {\n        code = str.charCodeAt(++index);\n    }\n    var urlChars = [];\n    var hasFinishedWord = false;\n    while (index < str.length) {\n        if (code === 0x0029) {\n            return [index, String.fromCharCode.apply(null, urlChars)];\n        }\n        else if (code === 0x0022 || code === 0x0027 || code === 0x0028) {\n            return null;\n        }\n        else if (code === 0x0009 || code === 0x0020 || code === 0x000a) {\n            if (!hasFinishedWord && urlChars.length !== 0)\n                hasFinishedWord = true;\n        }\n        else if (code === 0x005c) {\n            var result = consumeEscape(str, index);\n            if (result === null || hasFinishedWord)\n                return null;\n            var _a = __read(result, 2), lastIndex = _a[0], value = _a[1];\n            urlChars.push(value);\n            index = lastIndex;\n        }\n        else {\n            if (hasFinishedWord)\n                return null;\n            urlChars.push(code);\n        }\n        code = str.charCodeAt(++index);\n    }\n    return null;\n};\nexport var consumeIdentLike = function (str, index) {\n    var result = consumeIdent(str, index);\n    if (result === null)\n        return null;\n    var _a = __read(result, 2), lastIndex = _a[0], value = _a[1];\n    if (value.toLowerCase() === 'url') {\n        if (str.length > lastIndex + 1) {\n            var nextCode = str.charCodeAt(lastIndex + 1);\n            if (nextCode === 0x0028) {\n                for (var offset = 2; lastIndex + offset < str.length; offset += 1) {\n                    var nextNextCode = str.charCodeAt(lastIndex + offset);\n                    if (nextNextCode === 0x0022 || nextNextCode === 0x0027) {\n                        return [lastIndex + 1, value.toLowerCase(), '<function-token>'];\n                    }\n                    else if (nextNextCode !== 0x0009 &&\n                        nextNextCode !== 0x0020 &&\n                        nextNextCode !== 0x000a) {\n                        var result_1 = consumeUrl(str, lastIndex + offset);\n                        if (result_1 === null)\n                            return null;\n                        var _b = __read(result_1, 2), lastUrlIndex = _b[0], value_1 = _b[1];\n                        return [lastUrlIndex, value_1, '<url-token>'];\n                    }\n                }\n                return [lastIndex + 1, value.toLowerCase(), '<function-token>'];\n            }\n        }\n    }\n    else if (str.length > lastIndex + 1) {\n        var nextCode = str.charCodeAt(lastIndex + 1);\n        if (nextCode === 0x0028) {\n            return [lastIndex + 1, value.toLowerCase(), '<function-token>'];\n        }\n    }\n    return [lastIndex, value.toLowerCase(), '<ident-token>'];\n};\n//# sourceMappingURL=lexicalAnalysis.js.map","export var simplifyAST = function (ast) {\n    for (var i = ast.length - 1; i >= 0; i--) {\n        ast[i] = simplifyMediaQuery(ast[i]);\n    }\n    return ast;\n};\nvar simplifyMediaQuery = function (mediaQuery) {\n    if (mediaQuery.mediaCondition === null)\n        return mediaQuery;\n    var mediaCondition = simplifyMediaCondition(mediaQuery.mediaCondition);\n    if (mediaCondition.operator === null &&\n        mediaCondition.children.length === 1 &&\n        'children' in mediaCondition.children[0]) {\n        mediaCondition = mediaCondition.children[0];\n    }\n    return {\n        mediaPrefix: mediaQuery.mediaPrefix,\n        mediaType: mediaQuery.mediaType,\n        mediaCondition: mediaCondition\n    };\n};\nvar simplifyMediaCondition = function (mediaCondition) {\n    for (var i = mediaCondition.children.length - 1; i >= 0; i--) {\n        var unsimplifiedChild = mediaCondition.children[i];\n        if (!('context' in unsimplifiedChild)) {\n            var child = simplifyMediaCondition(unsimplifiedChild);\n            if (child.operator === null && child.children.length === 1) {\n                mediaCondition.children[i] = child.children[0];\n            }\n            else if (child.operator === mediaCondition.operator &&\n                (child.operator === 'and' || child.operator === 'or')) {\n                var spliceArgs = [i, 1];\n                for (var i_1 = 0; i_1 < child.children.length; i_1++) {\n                    spliceArgs.push(child.children[i_1]);\n                }\n                mediaCondition.children.splice.apply(mediaCondition.children, spliceArgs);\n            }\n        }\n    }\n    return mediaCondition;\n};\n//# sourceMappingURL=simplifyAST.js.map","import { __assign, __rest, __values } from \"tslib\";\nimport { lexicalAnalysis } from './lexicalAnalysis';\nimport { simplifyAST } from './simplifyAST';\nvar createError = function (message, err) {\n    if (err instanceof Error) {\n        return new Error(\"\".concat(err.message.trim(), \"\\n\").concat(message.trim()));\n    }\n    else {\n        return new Error(message.trim());\n    }\n};\nexport var toAST = function (str) {\n    return simplifyAST(toUnflattenedAST(str));\n};\nexport var toUnflattenedAST = function (str) {\n    var tokenList = lexicalAnalysis(str.trim());\n    if (tokenList === null) {\n        throw createError('Failed tokenizing');\n    }\n    var startIndex = 0;\n    var endIndex = tokenList.length - 1;\n    if (tokenList[0].type === '<at-keyword-token>' &&\n        tokenList[0].value === 'media') {\n        if (tokenList[1].type !== '<whitespace-token>') {\n            throw createError('Expected whitespace after media');\n        }\n        startIndex = 2;\n        for (var i = 2; i < tokenList.length - 1; i++) {\n            var token = tokenList[i];\n            if (token.type === '<{-token>') {\n                endIndex = i;\n                break;\n            }\n            else if (token.type === '<semicolon-token>') {\n                throw createError(\"Expected '{' in media query but found ';'\");\n            }\n        }\n    }\n    tokenList = tokenList.slice(startIndex, endIndex);\n    return syntacticAnalysis(tokenList);\n};\nexport var removeWhitespace = function (tokenList) {\n    var newTokenList = [];\n    var before = false;\n    for (var i = 0; i < tokenList.length; i++) {\n        if (tokenList[i].type === '<whitespace-token>') {\n            before = true;\n            if (newTokenList.length > 0) {\n                newTokenList[newTokenList.length - 1].wsAfter = true;\n            }\n        }\n        else {\n            newTokenList.push(__assign(__assign({}, tokenList[i]), { wsBefore: before, wsAfter: false }));\n            before = false;\n        }\n    }\n    return newTokenList;\n};\nexport var syntacticAnalysis = function (tokenList) {\n    var e_1, _a;\n    var mediaQueryList = [[]];\n    for (var i = 0; i < tokenList.length; i++) {\n        var token = tokenList[i];\n        if (token.type === '<comma-token>') {\n            mediaQueryList.push([]);\n        }\n        else {\n            mediaQueryList[mediaQueryList.length - 1].push(token);\n        }\n    }\n    var mediaQueries = mediaQueryList.map(removeWhitespace);\n    if (mediaQueries.length === 1 && mediaQueries[0].length === 0) {\n        return [{ mediaCondition: null, mediaPrefix: null, mediaType: 'all' }];\n    }\n    else {\n        var mediaQueryTokens = mediaQueries.map(function (mediaQueryTokens) {\n            if (mediaQueryTokens.length === 0) {\n                return null;\n            }\n            else {\n                return tokenizeMediaQuery(mediaQueryTokens);\n            }\n        });\n        var nonNullMediaQueryTokens = [];\n        try {\n            for (var mediaQueryTokens_1 = __values(mediaQueryTokens), mediaQueryTokens_1_1 = mediaQueryTokens_1.next(); !mediaQueryTokens_1_1.done; mediaQueryTokens_1_1 = mediaQueryTokens_1.next()) {\n                var mediaQueryToken = mediaQueryTokens_1_1.value;\n                if (mediaQueryToken !== null) {\n                    nonNullMediaQueryTokens.push(mediaQueryToken);\n                }\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (mediaQueryTokens_1_1 && !mediaQueryTokens_1_1.done && (_a = mediaQueryTokens_1.return)) _a.call(mediaQueryTokens_1);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n        if (nonNullMediaQueryTokens.length === 0) {\n            throw createError('No valid media queries');\n        }\n        return nonNullMediaQueryTokens;\n    }\n};\nexport var tokenizeMediaQuery = function (tokens) {\n    var firstToken = tokens[0];\n    if (firstToken.type === '<(-token>') {\n        try {\n            return {\n                mediaPrefix: null,\n                mediaType: 'all',\n                mediaCondition: tokenizeMediaCondition(tokens, true)\n            };\n        }\n        catch (err) {\n            throw createError(\"Expected media condition after '('\", err);\n        }\n    }\n    else if (firstToken.type === '<ident-token>') {\n        var mediaPrefix = null;\n        var mediaType = void 0;\n        var value = firstToken.value;\n        if (value === 'only' || value === 'not') {\n            mediaPrefix = value;\n        }\n        var firstIndex = mediaPrefix === null ? 0 : 1;\n        if (tokens.length <= firstIndex) {\n            throw createError(\"Expected extra token in media query\");\n        }\n        var firstNonUnaryToken = tokens[firstIndex];\n        if (firstNonUnaryToken.type === '<ident-token>') {\n            var value_1 = firstNonUnaryToken.value;\n            if (value_1 === 'all') {\n                mediaType = 'all';\n            }\n            else if (value_1 === 'print' || value_1 === 'screen') {\n                mediaType = value_1;\n            }\n            else if (value_1 === 'tty' ||\n                value_1 === 'tv' ||\n                value_1 === 'projection' ||\n                value_1 === 'handheld' ||\n                value_1 === 'braille' ||\n                value_1 === 'embossed' ||\n                value_1 === 'aural' ||\n                value_1 === 'speech') {\n                mediaPrefix = mediaPrefix === 'not' ? null : 'not';\n                mediaType = 'all';\n            }\n            else {\n                throw createError(\"Unknown ident '\".concat(value_1, \"' in media query\"));\n            }\n        }\n        else if (mediaPrefix === 'not' &&\n            firstNonUnaryToken.type === '<(-token>') {\n            var tokensWithParens = [\n                { type: '<(-token>', wsBefore: false, wsAfter: false }\n            ];\n            tokensWithParens.push.apply(tokensWithParens, tokens);\n            tokensWithParens.push({\n                type: '<)-token>',\n                wsBefore: false,\n                wsAfter: false\n            });\n            try {\n                return {\n                    mediaPrefix: null,\n                    mediaType: 'all',\n                    mediaCondition: tokenizeMediaCondition(tokensWithParens, true)\n                };\n            }\n            catch (err) {\n                throw createError(\"Expected media condition after '('\", err);\n            }\n        }\n        else {\n            throw createError('Invalid media query');\n        }\n        if (firstIndex + 1 === tokens.length) {\n            return {\n                mediaPrefix: mediaPrefix,\n                mediaType: mediaType,\n                mediaCondition: null\n            };\n        }\n        else if (firstIndex + 4 < tokens.length) {\n            var secondNonUnaryToken = tokens[firstIndex + 1];\n            if (secondNonUnaryToken.type === '<ident-token>' &&\n                secondNonUnaryToken.value === 'and') {\n                try {\n                    return {\n                        mediaPrefix: mediaPrefix,\n                        mediaType: mediaType,\n                        mediaCondition: tokenizeMediaCondition(tokens.slice(firstIndex + 2), false)\n                    };\n                }\n                catch (err) {\n                    throw createError(\"Expected media condition after 'and'\", err);\n                }\n            }\n            else {\n                throw createError(\"Expected 'and' after media prefix\");\n            }\n        }\n        else {\n            throw createError('Expected media condition after media prefix');\n        }\n    }\n    else {\n        throw createError('Expected media condition or media prefix');\n    }\n};\nexport var tokenizeMediaCondition = function (tokens, mayContainOr, previousOperator) {\n    if (previousOperator === void 0) { previousOperator = null; }\n    if (tokens.length < 3 ||\n        tokens[0].type !== '<(-token>' ||\n        tokens[tokens.length - 1].type !== '<)-token>') {\n        throw new Error('Invalid media condition');\n    }\n    var endIndexOfFirstFeature = tokens.length - 1;\n    var maxDepth = 0;\n    var count = 0;\n    for (var i = 0; i < tokens.length; i++) {\n        var token = tokens[i];\n        if (token.type === '<(-token>') {\n            count += 1;\n            maxDepth = Math.max(maxDepth, count);\n        }\n        else if (token.type === '<)-token>') {\n            count -= 1;\n        }\n        if (count === 0) {\n            endIndexOfFirstFeature = i;\n            break;\n        }\n    }\n    if (count !== 0) {\n        throw new Error('Mismatched parens\\nInvalid media condition');\n    }\n    var child;\n    var featureTokens = tokens.slice(0, endIndexOfFirstFeature + 1);\n    if (maxDepth === 1) {\n        child = tokenizeMediaFeature(featureTokens);\n    }\n    else {\n        if (featureTokens[1].type === '<ident-token>' &&\n            featureTokens[1].value === 'not') {\n            child = tokenizeMediaCondition(featureTokens.slice(2, -1), true, 'not');\n        }\n        else {\n            child = tokenizeMediaCondition(featureTokens.slice(1, -1), true);\n        }\n    }\n    if (endIndexOfFirstFeature === tokens.length - 1) {\n        return {\n            operator: previousOperator,\n            children: [child]\n        };\n    }\n    else {\n        var nextToken = tokens[endIndexOfFirstFeature + 1];\n        if (nextToken.type !== '<ident-token>') {\n            throw new Error('Invalid operator\\nInvalid media condition');\n        }\n        else if (previousOperator !== null &&\n            previousOperator !== nextToken.value) {\n            throw new Error(\"'\".concat(nextToken.value, \"' and '\").concat(previousOperator, \"' must not be at same level\\nInvalid media condition\"));\n        }\n        else if (nextToken.value === 'or' && !mayContainOr) {\n            throw new Error(\"Cannot use 'or' at top level of a media query\\nInvalid media condition\");\n        }\n        else if (nextToken.value !== 'and' && nextToken.value !== 'or') {\n            throw new Error(\"Invalid operator: '\".concat(nextToken.value, \"'\\nInvalid media condition\"));\n        }\n        var siblings = tokenizeMediaCondition(tokens.slice(endIndexOfFirstFeature + 2), mayContainOr, nextToken.value);\n        return {\n            operator: nextToken.value,\n            children: [child].concat(siblings.children)\n        };\n    }\n};\nexport var tokenizeMediaFeature = function (rawTokens) {\n    if (rawTokens.length < 3 ||\n        rawTokens[0].type !== '<(-token>' ||\n        rawTokens[rawTokens.length - 1].type !== '<)-token>') {\n        throw new Error('Invalid media feature');\n    }\n    var tokens = [rawTokens[0]];\n    for (var i = 1; i < rawTokens.length; i++) {\n        if (i < rawTokens.length - 2) {\n            var a = rawTokens[i];\n            var b = rawTokens[i + 1];\n            var c = rawTokens[i + 2];\n            if (a.type === '<number-token>' &&\n                a.value > 0 &&\n                b.type === '<delim-token>' &&\n                b.value === 0x002f &&\n                c.type === '<number-token>' &&\n                c.value > 0) {\n                tokens.push({\n                    type: '<ratio-token>',\n                    numerator: a.value,\n                    denominator: c.value,\n                    wsBefore: a.wsBefore,\n                    wsAfter: c.wsAfter\n                });\n                i += 2;\n                continue;\n            }\n        }\n        tokens.push(rawTokens[i]);\n    }\n    var nextToken = tokens[1];\n    if (nextToken.type === '<ident-token>' && tokens.length === 3) {\n        return {\n            context: 'boolean',\n            feature: nextToken.value\n        };\n    }\n    else if (tokens.length === 5 &&\n        tokens[1].type === '<ident-token>' &&\n        tokens[2].type === '<colon-token>') {\n        var valueToken = tokens[3];\n        if (valueToken.type === '<number-token>' ||\n            valueToken.type === '<dimension-token>' ||\n            valueToken.type === '<ratio-token>' ||\n            valueToken.type === '<ident-token>') {\n            var feature = tokens[1].value;\n            var prefix = null;\n            var slice = feature.slice(0, 4);\n            if (slice === 'min-') {\n                prefix = 'min';\n                feature = feature.slice(4);\n            }\n            else if (slice === 'max-') {\n                prefix = 'max';\n                feature = feature.slice(4);\n            }\n            var _0 = valueToken.wsBefore, _1 = valueToken.wsAfter, value = __rest(valueToken, [\"wsBefore\", \"wsAfter\"]);\n            return {\n                context: 'value',\n                prefix: prefix,\n                feature: feature,\n                value: value\n            };\n        }\n    }\n    else if (tokens.length >= 5) {\n        try {\n            var range = tokenizeRange(tokens);\n            return {\n                context: 'range',\n                feature: range.featureName,\n                range: range\n            };\n        }\n        catch (err) {\n            throw createError('Invalid media feature', err);\n        }\n    }\n    throw new Error('Invalid media feature');\n};\nexport var tokenizeRange = function (tokens) {\n    var _a, _b, _c, _d;\n    if (tokens.length < 5 ||\n        tokens[0].type !== '<(-token>' ||\n        tokens[tokens.length - 1].type !== '<)-token>') {\n        throw new Error('Invalid range');\n    }\n    var range = {\n        leftToken: null,\n        leftOp: null,\n        featureName: '',\n        rightOp: null,\n        rightToken: null\n    };\n    var hasLeft = tokens[1].type === '<number-token>' ||\n        tokens[1].type === '<dimension-token>' ||\n        tokens[1].type === '<ratio-token>' ||\n        (tokens[1].type === '<ident-token>' && tokens[1].value === 'infinite');\n    if (tokens[2].type === '<delim-token>') {\n        if (tokens[2].value === 0x003c) {\n            if (tokens[3].type === '<delim-token>' &&\n                tokens[3].value === 0x003d &&\n                !tokens[3].wsBefore) {\n                range[hasLeft ? 'leftOp' : 'rightOp'] = '<=';\n            }\n            else {\n                range[hasLeft ? 'leftOp' : 'rightOp'] = '<';\n            }\n        }\n        else if (tokens[2].value === 0x003e) {\n            if (tokens[3].type === '<delim-token>' &&\n                tokens[3].value === 0x003d &&\n                !tokens[3].wsBefore) {\n                range[hasLeft ? 'leftOp' : 'rightOp'] = '>=';\n            }\n            else {\n                range[hasLeft ? 'leftOp' : 'rightOp'] = '>';\n            }\n        }\n        else if (tokens[2].value === 0x003d) {\n            range[hasLeft ? 'leftOp' : 'rightOp'] = '=';\n        }\n        else {\n            throw new Error('Invalid range');\n        }\n        if (hasLeft) {\n            range.leftToken = tokens[1];\n        }\n        else if (tokens[1].type === '<ident-token>') {\n            range.featureName = tokens[1].value;\n        }\n        else {\n            throw new Error('Invalid range');\n        }\n        var tokenIndexAfterFirstOp = 2 + ((_b = (_a = range[hasLeft ? 'leftOp' : 'rightOp']) === null || _a === void 0 ? void 0 : _a.length) !== null && _b !== void 0 ? _b : 0);\n        var tokenAfterFirstOp = tokens[tokenIndexAfterFirstOp];\n        if (hasLeft) {\n            if (tokenAfterFirstOp.type === '<ident-token>') {\n                range.featureName = tokenAfterFirstOp.value;\n                if (tokens.length >= 7) {\n                    var secondOpToken = tokens[tokenIndexAfterFirstOp + 1];\n                    var followingToken = tokens[tokenIndexAfterFirstOp + 2];\n                    if (secondOpToken.type === '<delim-token>') {\n                        var charCode = secondOpToken.value;\n                        if (charCode === 0x003c) {\n                            if (followingToken.type === '<delim-token>' &&\n                                followingToken.value === 0x003d &&\n                                !followingToken.wsBefore) {\n                                range.rightOp = '<=';\n                            }\n                            else {\n                                range.rightOp = '<';\n                            }\n                        }\n                        else if (charCode === 0x003e) {\n                            if (followingToken.type === '<delim-token>' &&\n                                followingToken.value === 0x003d &&\n                                !followingToken.wsBefore) {\n                                range.rightOp = '>=';\n                            }\n                            else {\n                                range.rightOp = '>';\n                            }\n                        }\n                        else {\n                            throw new Error('Invalid range');\n                        }\n                        var tokenAfterSecondOp = tokens[tokenIndexAfterFirstOp + 1 + ((_d = (_c = range.rightOp) === null || _c === void 0 ? void 0 : _c.length) !== null && _d !== void 0 ? _d : 0)];\n                        range.rightToken = tokenAfterSecondOp;\n                    }\n                    else {\n                        throw new Error('Invalid range');\n                    }\n                }\n                else if (tokenIndexAfterFirstOp + 2 !== tokens.length) {\n                    throw new Error('Invalid range');\n                }\n            }\n            else {\n                throw new Error('Invalid range');\n            }\n        }\n        else {\n            range.rightToken = tokenAfterFirstOp;\n        }\n        var validRange = null;\n        var lt = range.leftToken, leftOp = range.leftOp, featureName = range.featureName, rightOp = range.rightOp, rt = range.rightToken;\n        var leftToken = null;\n        if (lt !== null) {\n            if (lt.type === '<ident-token>') {\n                var type = lt.type, value = lt.value;\n                if (value === 'infinite') {\n                    leftToken = { type: type, value: value };\n                }\n            }\n            else if (lt.type === '<number-token>' ||\n                lt.type === '<dimension-token>' ||\n                lt.type === '<ratio-token>') {\n                var _0 = lt.wsBefore, _1 = lt.wsAfter, ltNoWS = __rest(lt, [\"wsBefore\", \"wsAfter\"]);\n                leftToken = ltNoWS;\n            }\n        }\n        var rightToken = null;\n        if (rt !== null) {\n            if (rt.type === '<ident-token>') {\n                var type = rt.type, value = rt.value;\n                if (value === 'infinite') {\n                    rightToken = { type: type, value: value };\n                }\n            }\n            else if (rt.type === '<number-token>' ||\n                rt.type === '<dimension-token>' ||\n                rt.type === '<ratio-token>') {\n                var _0 = rt.wsBefore, _1 = rt.wsAfter, rtNoWS = __rest(rt, [\"wsBefore\", \"wsAfter\"]);\n                rightToken = rtNoWS;\n            }\n        }\n        if (leftToken !== null && rightToken !== null) {\n            if ((leftOp === '<' || leftOp === '<=') &&\n                (rightOp === '<' || rightOp === '<=')) {\n                validRange = { leftToken: leftToken, leftOp: leftOp, featureName: featureName, rightOp: rightOp, rightToken: rightToken };\n            }\n            else if ((leftOp === '>' || leftOp === '>=') &&\n                (rightOp === '>' || rightOp === '>=')) {\n                validRange = { leftToken: leftToken, leftOp: leftOp, featureName: featureName, rightOp: rightOp, rightToken: rightToken };\n            }\n            else {\n                throw new Error('Invalid range');\n            }\n        }\n        else if (leftToken === null &&\n            leftOp === null &&\n            rightOp !== null &&\n            rightToken !== null) {\n            validRange = { leftToken: leftToken, leftOp: leftOp, featureName: featureName, rightOp: rightOp, rightToken: rightToken };\n        }\n        else if (leftToken !== null &&\n            leftOp !== null &&\n            rightOp === null &&\n            rightToken === null) {\n            validRange = { leftToken: leftToken, leftOp: leftOp, featureName: featureName, rightOp: rightOp, rightToken: rightToken };\n        }\n        return validRange;\n    }\n    else {\n        throw new Error('Invalid range');\n    }\n};\n//# sourceMappingURL=syntacticAnalysis.js.map"],"names":["weirdNewlines","nullOrSurrogates","commentRegex","lexicalAnalysis","str","index","replace","tokens","length","code","charCodeAt","code_1","push","type","result","consumeString","lastIndex","value","nextCode","flag","wouldStartIdentifier","consumeIdentUnsafe","toLowerCase","plusNumeric","consumeNumeric","tokenTuple","unit","minusNumeric","nextNextCode","consumeIdentLike","nextNextNextCode","consumeIdent","consumeEscape","slice","firstCode","charCodes","i","String","fromCharCode","apply","charCode","hexCharCodes","min","Math","code_2","code_3","parseInt","numberResult","consumeNumber","numberEndIndex","numberValue","numberFlag","identResult","identEndIndex","identValue","numberChars","nextNextIsDigit","numberString","parseFloat","Number","isNaN","identChars","code_4","code_5","consumeUrl","urlChars","hasFinishedWord","offset","result_1","lastUrlIndex","value_1","simplifyAST","ast","simplifyMediaQuery","mediaQuery","mediaCondition","simplifyMediaCondition","operator","children","mediaPrefix","mediaType","unsimplifiedChild","child","spliceArgs","i_1","splice","createError","message","err","Error","trim","concat","toAST","toUnflattenedAST","tokenList","startIndex","endIndex","token","syntacticAnalysis","removeWhitespace","newTokenList","before","wsAfter","__assign","wsBefore","mediaQueryList","mediaQueries","map","mediaQueryTokens","tokenizeMediaQuery","nonNullMediaQueryTokens","mediaQueryTokens_1_1","mediaQueryToken","firstToken","tokenizeMediaCondition","firstIndex","firstNonUnaryToken","tokensWithParens","secondNonUnaryToken","mayContainOr","previousOperator","endIndexOfFirstFeature","maxDepth","count","max","featureTokens","tokenizeMediaFeature","nextToken","siblings","rawTokens","a","b","c","numerator","denominator","context","feature","valueToken","prefix","range","tokenizeRange","featureName","leftToken","leftOp","rightOp","rightToken","hasLeft","tokenIndexAfterFirstOp","_a","_b","tokenAfterFirstOp","secondOpToken","followingToken","tokenAfterSecondOp","_c","_d","validRange","lt","rt","ltNoWS","rtNoWS"],"mappings":"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"}