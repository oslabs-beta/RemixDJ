{"version":3,"file":"media-query-parser.umd.js","sources":["../node_modules/tslib/tslib.es6.js","../compiled/parse/lexicalAnalysis.js","../compiled/parse/simplifyAST.js","../compiled/parse/syntacticAnalysis.js"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __createBinding(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","import { __read } from \"tslib\";\nvar weirdNewlines = /(\\u000D|\\u000C|\\u000D\\u000A)/g;\nvar nullOrSurrogates = /[\\u0000\\uD800-\\uDFFF]/g;\nvar commentRegex = /(\\/\\*)[\\s\\S]*?(\\*\\/)/g;\nexport var lexicalAnalysis = function (str, index) {\n    if (index === void 0) { index = 0; }\n    str = str.replace(weirdNewlines, '\\n').replace(nullOrSurrogates, '\\uFFFD');\n    str = str.replace(commentRegex, '');\n    var tokens = [];\n    for (; index < str.length; index += 1) {\n        var code = str.charCodeAt(index);\n        if (code === 0x0009 || code === 0x0020 || code === 0x000a) {\n            var code_1 = str.charCodeAt(++index);\n            while (code_1 === 0x0009 || code_1 === 0x0020 || code_1 === 0x000a) {\n                code_1 = str.charCodeAt(++index);\n            }\n            index -= 1;\n            tokens.push({\n                type: '<whitespace-token>'\n            });\n        }\n        else if (code === 0x0022) {\n            var result = consumeString(str, index);\n            if (result === null) {\n                return null;\n            }\n            var _a = __read(result, 2), lastIndex = _a[0], value = _a[1];\n            tokens.push({\n                type: '<string-token>',\n                value: value\n            });\n            index = lastIndex;\n        }\n        else if (code === 0x0023) {\n            if (index + 1 < str.length) {\n                var nextCode = str.charCodeAt(index + 1);\n                if (nextCode === 0x005f ||\n                    (nextCode >= 0x0041 && nextCode <= 0x005a) ||\n                    (nextCode >= 0x0061 && nextCode <= 0x007a) ||\n                    nextCode >= 0x0080 ||\n                    (nextCode >= 0x0030 && nextCode <= 0x0039) ||\n                    (nextCode === 0x005c &&\n                        index + 2 < str.length &&\n                        str.charCodeAt(index + 2) !== 0x000a)) {\n                    var flag = wouldStartIdentifier(str, index + 1)\n                        ? 'id'\n                        : 'unrestricted';\n                    var result = consumeIdentUnsafe(str, index + 1);\n                    if (result !== null) {\n                        var _b = __read(result, 2), lastIndex = _b[0], value = _b[1];\n                        tokens.push({\n                            type: '<hash-token>',\n                            value: value.toLowerCase(),\n                            flag: flag\n                        });\n                        index = lastIndex;\n                        continue;\n                    }\n                }\n            }\n            tokens.push({ type: '<delim-token>', value: code });\n        }\n        else if (code === 0x0027) {\n            var result = consumeString(str, index);\n            if (result === null) {\n                return null;\n            }\n            var _c = __read(result, 2), lastIndex = _c[0], value = _c[1];\n            tokens.push({\n                type: '<string-token>',\n                value: value\n            });\n            index = lastIndex;\n        }\n        else if (code === 0x0028) {\n            tokens.push({ type: '<(-token>' });\n        }\n        else if (code === 0x0029) {\n            tokens.push({ type: '<)-token>' });\n        }\n        else if (code === 0x002b) {\n            var plusNumeric = consumeNumeric(str, index);\n            if (plusNumeric === null) {\n                tokens.push({\n                    type: '<delim-token>',\n                    value: code\n                });\n            }\n            else {\n                var _d = __read(plusNumeric, 2), lastIndex = _d[0], tokenTuple = _d[1];\n                if (tokenTuple[0] === '<dimension-token>') {\n                    tokens.push({\n                        type: '<dimension-token>',\n                        value: tokenTuple[1],\n                        unit: tokenTuple[2].toLowerCase(),\n                        flag: 'number'\n                    });\n                }\n                else if (tokenTuple[0] === '<number-token>') {\n                    tokens.push({\n                        type: tokenTuple[0],\n                        value: tokenTuple[1],\n                        flag: tokenTuple[2]\n                    });\n                }\n                else {\n                    tokens.push({\n                        type: tokenTuple[0],\n                        value: tokenTuple[1],\n                        flag: 'number'\n                    });\n                }\n                index = lastIndex;\n            }\n        }\n        else if (code === 0x002c) {\n            tokens.push({ type: '<comma-token>' });\n        }\n        else if (code === 0x002d) {\n            var minusNumeric = consumeNumeric(str, index);\n            if (minusNumeric !== null) {\n                var _e = __read(minusNumeric, 2), lastIndex = _e[0], tokenTuple = _e[1];\n                if (tokenTuple[0] === '<dimension-token>') {\n                    tokens.push({\n                        type: '<dimension-token>',\n                        value: tokenTuple[1],\n                        unit: tokenTuple[2].toLowerCase(),\n                        flag: 'number'\n                    });\n                }\n                else if (tokenTuple[0] === '<number-token>') {\n                    tokens.push({\n                        type: tokenTuple[0],\n                        value: tokenTuple[1],\n                        flag: tokenTuple[2]\n                    });\n                }\n                else {\n                    tokens.push({\n                        type: tokenTuple[0],\n                        value: tokenTuple[1],\n                        flag: 'number'\n                    });\n                }\n                index = lastIndex;\n                continue;\n            }\n            if (index + 2 < str.length) {\n                var nextCode = str.charCodeAt(index + 1);\n                var nextNextCode = str.charCodeAt(index + 2);\n                if (nextCode === 0x002d && nextNextCode === 0x003e) {\n                    tokens.push({\n                        type: '<CDC-token>'\n                    });\n                    index += 2;\n                    continue;\n                }\n            }\n            var result = consumeIdentLike(str, index);\n            if (result !== null) {\n                var _f = __read(result, 3), lastIndex = _f[0], value = _f[1], type = _f[2];\n                tokens.push({\n                    type: type,\n                    value: value\n                });\n                index = lastIndex;\n                continue;\n            }\n            tokens.push({\n                type: '<delim-token>',\n                value: code\n            });\n        }\n        else if (code === 0x002e) {\n            var minusNumeric = consumeNumeric(str, index);\n            if (minusNumeric === null) {\n                tokens.push({\n                    type: '<delim-token>',\n                    value: code\n                });\n            }\n            else {\n                var _g = __read(minusNumeric, 2), lastIndex = _g[0], tokenTuple = _g[1];\n                if (tokenTuple[0] === '<dimension-token>') {\n                    tokens.push({\n                        type: '<dimension-token>',\n                        value: tokenTuple[1],\n                        unit: tokenTuple[2].toLowerCase(),\n                        flag: 'number'\n                    });\n                }\n                else if (tokenTuple[0] === '<number-token>') {\n                    tokens.push({\n                        type: tokenTuple[0],\n                        value: tokenTuple[1],\n                        flag: tokenTuple[2]\n                    });\n                }\n                else {\n                    tokens.push({\n                        type: tokenTuple[0],\n                        value: tokenTuple[1],\n                        flag: 'number'\n                    });\n                }\n                index = lastIndex;\n                continue;\n            }\n        }\n        else if (code === 0x003a) {\n            tokens.push({ type: '<colon-token>' });\n        }\n        else if (code === 0x003b) {\n            tokens.push({ type: '<semicolon-token>' });\n        }\n        else if (code === 0x003c) {\n            if (index + 3 < str.length) {\n                var nextCode = str.charCodeAt(index + 1);\n                var nextNextCode = str.charCodeAt(index + 2);\n                var nextNextNextCode = str.charCodeAt(index + 3);\n                if (nextCode === 0x0021 &&\n                    nextNextCode === 0x002d &&\n                    nextNextNextCode === 0x002d) {\n                    tokens.push({\n                        type: '<CDO-token>'\n                    });\n                    index += 3;\n                    continue;\n                }\n            }\n            tokens.push({\n                type: '<delim-token>',\n                value: code\n            });\n        }\n        else if (code === 0x0040) {\n            var result = consumeIdent(str, index + 1);\n            if (result !== null) {\n                var _h = __read(result, 2), lastIndex = _h[0], value = _h[1];\n                tokens.push({\n                    type: '<at-keyword-token>',\n                    value: value.toLowerCase()\n                });\n                index = lastIndex;\n                continue;\n            }\n            tokens.push({ type: '<delim-token>', value: code });\n        }\n        else if (code === 0x005b) {\n            tokens.push({ type: '<[-token>' });\n        }\n        else if (code === 0x005c) {\n            var result = consumeEscape(str, index);\n            if (result === null) {\n                return null;\n            }\n            var _j = __read(result, 2), lastIndex = _j[0], value = _j[1];\n            str = str.slice(0, index) + value + str.slice(lastIndex + 1);\n            index -= 1;\n        }\n        else if (code === 0x005d) {\n            tokens.push({ type: '<]-token>' });\n        }\n        else if (code === 0x007b) {\n            tokens.push({ type: '<{-token>' });\n        }\n        else if (code === 0x007d) {\n            tokens.push({ type: '<}-token>' });\n        }\n        else if (code >= 0x0030 && code <= 0x0039) {\n            var result = consumeNumeric(str, index);\n            var _k = __read(result, 2), lastIndex = _k[0], tokenTuple = _k[1];\n            if (tokenTuple[0] === '<dimension-token>') {\n                tokens.push({\n                    type: '<dimension-token>',\n                    value: tokenTuple[1],\n                    unit: tokenTuple[2].toLowerCase(),\n                    flag: 'number'\n                });\n            }\n            else if (tokenTuple[0] === '<number-token>') {\n                tokens.push({\n                    type: tokenTuple[0],\n                    value: tokenTuple[1],\n                    flag: tokenTuple[2]\n                });\n            }\n            else {\n                tokens.push({\n                    type: tokenTuple[0],\n                    value: tokenTuple[1],\n                    flag: 'number'\n                });\n            }\n            index = lastIndex;\n        }\n        else if (code === 0x005f ||\n            (code >= 0x0041 && code <= 0x005a) ||\n            (code >= 0x0061 && code <= 0x007a) ||\n            code >= 0x0080) {\n            var result = consumeIdentLike(str, index);\n            if (result === null) {\n                return null;\n            }\n            var _l = __read(result, 3), lastIndex = _l[0], value = _l[1], type = _l[2];\n            tokens.push({\n                type: type,\n                value: value\n            });\n            index = lastIndex;\n        }\n        else {\n            tokens.push({ type: '<delim-token>', value: code });\n        }\n    }\n    tokens.push({ type: '<EOF-token>' });\n    return tokens;\n};\nexport var consumeString = function (str, index) {\n    if (str.length <= index + 1)\n        return null;\n    var firstCode = str.charCodeAt(index);\n    var charCodes = [];\n    for (var i = index + 1; i < str.length; i += 1) {\n        var code = str.charCodeAt(i);\n        if (code === firstCode) {\n            return [i, String.fromCharCode.apply(null, charCodes)];\n        }\n        else if (code === 0x005c) {\n            var result = consumeEscape(str, i);\n            if (result === null)\n                return null;\n            var _a = __read(result, 2), lastIndex = _a[0], charCode = _a[1];\n            charCodes.push(charCode);\n            i = lastIndex;\n        }\n        else if (code === 0x000a) {\n            return null;\n        }\n        else {\n            charCodes.push(code);\n        }\n    }\n    return null;\n};\nexport var wouldStartIdentifier = function (str, index) {\n    if (str.length <= index)\n        return false;\n    var code = str.charCodeAt(index);\n    if (code === 0x002d) {\n        if (str.length <= index + 1)\n            return false;\n        var nextCode = str.charCodeAt(index + 1);\n        if (nextCode === 0x002d ||\n            nextCode === 0x005f ||\n            (nextCode >= 0x0041 && nextCode <= 0x005a) ||\n            (nextCode >= 0x0061 && nextCode <= 0x007a) ||\n            nextCode >= 0x0080) {\n            return true;\n        }\n        else if (nextCode === 0x005c) {\n            if (str.length <= index + 2)\n                return false;\n            var nextNextCode = str.charCodeAt(index + 2);\n            return nextNextCode !== 0x000a;\n        }\n        else {\n            return false;\n        }\n    }\n    else if (code === 0x005f ||\n        (code >= 0x0041 && code <= 0x005a) ||\n        (code >= 0x0061 && code <= 0x007a) ||\n        code >= 0x0080) {\n        return true;\n    }\n    else if (code === 0x005c) {\n        if (str.length <= index + 1)\n            return false;\n        var nextCode = str.charCodeAt(index + 1);\n        return nextCode !== 0x000a;\n    }\n    else {\n        return false;\n    }\n};\nexport var consumeEscape = function (str, index) {\n    if (str.length <= index + 1)\n        return null;\n    if (str.charCodeAt(index) !== 0x005c)\n        return null;\n    var code = str.charCodeAt(index + 1);\n    if (code === 0x000a) {\n        return null;\n    }\n    else if ((code >= 0x0030 && code <= 0x0039) ||\n        (code >= 0x0041 && code <= 0x0046) ||\n        (code >= 0x0061 && code <= 0x0066)) {\n        var hexCharCodes = [code];\n        var min = Math.min(index + 7, str.length);\n        var i = index + 2;\n        for (; i < min; i += 1) {\n            var code_2 = str.charCodeAt(i);\n            if ((code_2 >= 0x0030 && code_2 <= 0x0039) ||\n                (code_2 >= 0x0041 && code_2 <= 0x0046) ||\n                (code_2 >= 0x0061 && code_2 <= 0x0066)) {\n                hexCharCodes.push(code_2);\n            }\n            else {\n                break;\n            }\n        }\n        if (i < str.length) {\n            var code_3 = str.charCodeAt(i);\n            if (code_3 === 0x0009 || code_3 === 0x0020 || code_3 === 0x000a) {\n                i += 1;\n            }\n        }\n        return [i - 1, parseInt(String.fromCharCode.apply(null, hexCharCodes), 16)];\n    }\n    else {\n        return [index + 1, code];\n    }\n};\nexport var consumeNumeric = function (str, index) {\n    var numberResult = consumeNumber(str, index);\n    if (numberResult === null)\n        return null;\n    var _a = __read(numberResult, 3), numberEndIndex = _a[0], numberValue = _a[1], numberFlag = _a[2];\n    var identResult = consumeIdent(str, numberEndIndex + 1);\n    if (identResult !== null) {\n        var _b = __read(identResult, 2), identEndIndex = _b[0], identValue = _b[1];\n        return [identEndIndex, ['<dimension-token>', numberValue, identValue]];\n    }\n    if (numberEndIndex + 1 < str.length &&\n        str.charCodeAt(numberEndIndex + 1) === 0x0025) {\n        return [numberEndIndex + 1, ['<percentage-token>', numberValue]];\n    }\n    return [numberEndIndex, ['<number-token>', numberValue, numberFlag]];\n};\nexport var consumeNumber = function (str, index) {\n    if (str.length <= index)\n        return null;\n    var flag = 'integer';\n    var numberChars = [];\n    var firstCode = str.charCodeAt(index);\n    if (firstCode === 0x002b || firstCode === 0x002d) {\n        index += 1;\n        if (firstCode === 0x002d)\n            numberChars.push(0x002d);\n    }\n    while (index < str.length) {\n        var code = str.charCodeAt(index);\n        if (code >= 0x0030 && code <= 0x0039) {\n            numberChars.push(code);\n            index += 1;\n        }\n        else {\n            break;\n        }\n    }\n    if (index + 1 < str.length) {\n        var nextCode = str.charCodeAt(index);\n        var nextNextCode = str.charCodeAt(index + 1);\n        if (nextCode === 0x002e &&\n            nextNextCode >= 0x0030 &&\n            nextNextCode <= 0x0039) {\n            numberChars.push(nextCode, nextNextCode);\n            flag = 'number';\n            index += 2;\n            while (index < str.length) {\n                var code = str.charCodeAt(index);\n                if (code >= 0x0030 && code <= 0x0039) {\n                    numberChars.push(code);\n                    index += 1;\n                }\n                else {\n                    break;\n                }\n            }\n        }\n    }\n    if (index + 1 < str.length) {\n        var nextCode = str.charCodeAt(index);\n        var nextNextCode = str.charCodeAt(index + 1);\n        var nextNextNextCode = str.charCodeAt(index + 2);\n        if (nextCode === 0x0045 || nextCode === 0x0065) {\n            var nextNextIsDigit = nextNextCode >= 0x0030 && nextNextCode <= 0x0039;\n            if (nextNextIsDigit ||\n                ((nextNextCode === 0x002b || nextNextCode === 0x002d) &&\n                    nextNextNextCode >= 0x0030 &&\n                    nextNextNextCode <= 0x0039)) {\n                flag = 'number';\n                if (nextNextIsDigit) {\n                    numberChars.push(0x0045, nextNextCode);\n                    index += 2;\n                }\n                else if (nextNextCode === 0x002d) {\n                    numberChars.push(0x0045, 0x002d, nextNextNextCode);\n                    index += 3;\n                }\n                else {\n                    numberChars.push(0x0045, nextNextNextCode);\n                    index += 3;\n                }\n                while (index < str.length) {\n                    var code = str.charCodeAt(index);\n                    if (code >= 0x0030 && code <= 0x0039) {\n                        numberChars.push(code);\n                        index += 1;\n                    }\n                    else {\n                        break;\n                    }\n                }\n            }\n        }\n    }\n    var numberString = String.fromCharCode.apply(null, numberChars);\n    var value = flag === 'number' ? parseFloat(numberString) : parseInt(numberString);\n    if (value === -0)\n        value = 0;\n    return Number.isNaN(value) ? null : [index - 1, value, flag];\n};\nexport var consumeIdentUnsafe = function (str, index) {\n    if (str.length <= index) {\n        return null;\n    }\n    var identChars = [];\n    for (var code = str.charCodeAt(index); index < str.length; code = str.charCodeAt(++index)) {\n        if (code === 0x002d ||\n            code === 0x005f ||\n            (code >= 0x0041 && code <= 0x005a) ||\n            (code >= 0x0061 && code <= 0x007a) ||\n            code >= 0x0080 ||\n            (code >= 0x0030 && code <= 0x0039)) {\n            identChars.push(code);\n            continue;\n        }\n        else {\n            var result = consumeEscape(str, index);\n            if (result !== null) {\n                var _a = __read(result, 2), lastIndex = _a[0], code_4 = _a[1];\n                identChars.push(code_4);\n                index = lastIndex;\n                continue;\n            }\n        }\n        break;\n    }\n    return index === 0\n        ? null\n        : [index - 1, String.fromCharCode.apply(null, identChars)];\n};\nexport var consumeIdent = function (str, index) {\n    if (str.length <= index || !wouldStartIdentifier(str, index)) {\n        return null;\n    }\n    var identChars = [];\n    for (var code = str.charCodeAt(index); index < str.length; code = str.charCodeAt(++index)) {\n        if (code === 0x002d ||\n            code === 0x005f ||\n            (code >= 0x0041 && code <= 0x005a) ||\n            (code >= 0x0061 && code <= 0x007a) ||\n            code >= 0x0080 ||\n            (code >= 0x0030 && code <= 0x0039)) {\n            identChars.push(code);\n            continue;\n        }\n        else {\n            var result = consumeEscape(str, index);\n            if (result !== null) {\n                var _a = __read(result, 2), lastIndex = _a[0], code_5 = _a[1];\n                identChars.push(code_5);\n                index = lastIndex;\n                continue;\n            }\n        }\n        break;\n    }\n    return [index - 1, String.fromCharCode.apply(null, identChars)];\n};\nexport var consumeUrl = function (str, index) {\n    var code = str.charCodeAt(index);\n    while (code === 0x0009 || code === 0x0020 || code === 0x000a) {\n        code = str.charCodeAt(++index);\n    }\n    var urlChars = [];\n    var hasFinishedWord = false;\n    while (index < str.length) {\n        if (code === 0x0029) {\n            return [index, String.fromCharCode.apply(null, urlChars)];\n        }\n        else if (code === 0x0022 || code === 0x0027 || code === 0x0028) {\n            return null;\n        }\n        else if (code === 0x0009 || code === 0x0020 || code === 0x000a) {\n            if (!hasFinishedWord && urlChars.length !== 0)\n                hasFinishedWord = true;\n        }\n        else if (code === 0x005c) {\n            var result = consumeEscape(str, index);\n            if (result === null || hasFinishedWord)\n                return null;\n            var _a = __read(result, 2), lastIndex = _a[0], value = _a[1];\n            urlChars.push(value);\n            index = lastIndex;\n        }\n        else {\n            if (hasFinishedWord)\n                return null;\n            urlChars.push(code);\n        }\n        code = str.charCodeAt(++index);\n    }\n    return null;\n};\nexport var consumeIdentLike = function (str, index) {\n    var result = consumeIdent(str, index);\n    if (result === null)\n        return null;\n    var _a = __read(result, 2), lastIndex = _a[0], value = _a[1];\n    if (value.toLowerCase() === 'url') {\n        if (str.length > lastIndex + 1) {\n            var nextCode = str.charCodeAt(lastIndex + 1);\n            if (nextCode === 0x0028) {\n                for (var offset = 2; lastIndex + offset < str.length; offset += 1) {\n                    var nextNextCode = str.charCodeAt(lastIndex + offset);\n                    if (nextNextCode === 0x0022 || nextNextCode === 0x0027) {\n                        return [lastIndex + 1, value.toLowerCase(), '<function-token>'];\n                    }\n                    else if (nextNextCode !== 0x0009 &&\n                        nextNextCode !== 0x0020 &&\n                        nextNextCode !== 0x000a) {\n                        var result_1 = consumeUrl(str, lastIndex + offset);\n                        if (result_1 === null)\n                            return null;\n                        var _b = __read(result_1, 2), lastUrlIndex = _b[0], value_1 = _b[1];\n                        return [lastUrlIndex, value_1, '<url-token>'];\n                    }\n                }\n                return [lastIndex + 1, value.toLowerCase(), '<function-token>'];\n            }\n        }\n    }\n    else if (str.length > lastIndex + 1) {\n        var nextCode = str.charCodeAt(lastIndex + 1);\n        if (nextCode === 0x0028) {\n            return [lastIndex + 1, value.toLowerCase(), '<function-token>'];\n        }\n    }\n    return [lastIndex, value.toLowerCase(), '<ident-token>'];\n};\n//# sourceMappingURL=lexicalAnalysis.js.map","export var simplifyAST = function (ast) {\n    for (var i = ast.length - 1; i >= 0; i--) {\n        ast[i] = simplifyMediaQuery(ast[i]);\n    }\n    return ast;\n};\nvar simplifyMediaQuery = function (mediaQuery) {\n    if (mediaQuery.mediaCondition === null)\n        return mediaQuery;\n    var mediaCondition = simplifyMediaCondition(mediaQuery.mediaCondition);\n    if (mediaCondition.operator === null &&\n        mediaCondition.children.length === 1 &&\n        'children' in mediaCondition.children[0]) {\n        mediaCondition = mediaCondition.children[0];\n    }\n    return {\n        mediaPrefix: mediaQuery.mediaPrefix,\n        mediaType: mediaQuery.mediaType,\n        mediaCondition: mediaCondition\n    };\n};\nvar simplifyMediaCondition = function (mediaCondition) {\n    for (var i = mediaCondition.children.length - 1; i >= 0; i--) {\n        var unsimplifiedChild = mediaCondition.children[i];\n        if (!('context' in unsimplifiedChild)) {\n            var child = simplifyMediaCondition(unsimplifiedChild);\n            if (child.operator === null && child.children.length === 1) {\n                mediaCondition.children[i] = child.children[0];\n            }\n            else if (child.operator === mediaCondition.operator &&\n                (child.operator === 'and' || child.operator === 'or')) {\n                var spliceArgs = [i, 1];\n                for (var i_1 = 0; i_1 < child.children.length; i_1++) {\n                    spliceArgs.push(child.children[i_1]);\n                }\n                mediaCondition.children.splice.apply(mediaCondition.children, spliceArgs);\n            }\n        }\n    }\n    return mediaCondition;\n};\n//# sourceMappingURL=simplifyAST.js.map","import { __assign, __rest, __values } from \"tslib\";\nimport { lexicalAnalysis } from './lexicalAnalysis';\nimport { simplifyAST } from './simplifyAST';\nvar createError = function (message, err) {\n    if (err instanceof Error) {\n        return new Error(\"\".concat(err.message.trim(), \"\\n\").concat(message.trim()));\n    }\n    else {\n        return new Error(message.trim());\n    }\n};\nexport var toAST = function (str) {\n    return simplifyAST(toUnflattenedAST(str));\n};\nexport var toUnflattenedAST = function (str) {\n    var tokenList = lexicalAnalysis(str.trim());\n    if (tokenList === null) {\n        throw createError('Failed tokenizing');\n    }\n    var startIndex = 0;\n    var endIndex = tokenList.length - 1;\n    if (tokenList[0].type === '<at-keyword-token>' &&\n        tokenList[0].value === 'media') {\n        if (tokenList[1].type !== '<whitespace-token>') {\n            throw createError('Expected whitespace after media');\n        }\n        startIndex = 2;\n        for (var i = 2; i < tokenList.length - 1; i++) {\n            var token = tokenList[i];\n            if (token.type === '<{-token>') {\n                endIndex = i;\n                break;\n            }\n            else if (token.type === '<semicolon-token>') {\n                throw createError(\"Expected '{' in media query but found ';'\");\n            }\n        }\n    }\n    tokenList = tokenList.slice(startIndex, endIndex);\n    return syntacticAnalysis(tokenList);\n};\nexport var removeWhitespace = function (tokenList) {\n    var newTokenList = [];\n    var before = false;\n    for (var i = 0; i < tokenList.length; i++) {\n        if (tokenList[i].type === '<whitespace-token>') {\n            before = true;\n            if (newTokenList.length > 0) {\n                newTokenList[newTokenList.length - 1].wsAfter = true;\n            }\n        }\n        else {\n            newTokenList.push(__assign(__assign({}, tokenList[i]), { wsBefore: before, wsAfter: false }));\n            before = false;\n        }\n    }\n    return newTokenList;\n};\nexport var syntacticAnalysis = function (tokenList) {\n    var e_1, _a;\n    var mediaQueryList = [[]];\n    for (var i = 0; i < tokenList.length; i++) {\n        var token = tokenList[i];\n        if (token.type === '<comma-token>') {\n            mediaQueryList.push([]);\n        }\n        else {\n            mediaQueryList[mediaQueryList.length - 1].push(token);\n        }\n    }\n    var mediaQueries = mediaQueryList.map(removeWhitespace);\n    if (mediaQueries.length === 1 && mediaQueries[0].length === 0) {\n        return [{ mediaCondition: null, mediaPrefix: null, mediaType: 'all' }];\n    }\n    else {\n        var mediaQueryTokens = mediaQueries.map(function (mediaQueryTokens) {\n            if (mediaQueryTokens.length === 0) {\n                return null;\n            }\n            else {\n                return tokenizeMediaQuery(mediaQueryTokens);\n            }\n        });\n        var nonNullMediaQueryTokens = [];\n        try {\n            for (var mediaQueryTokens_1 = __values(mediaQueryTokens), mediaQueryTokens_1_1 = mediaQueryTokens_1.next(); !mediaQueryTokens_1_1.done; mediaQueryTokens_1_1 = mediaQueryTokens_1.next()) {\n                var mediaQueryToken = mediaQueryTokens_1_1.value;\n                if (mediaQueryToken !== null) {\n                    nonNullMediaQueryTokens.push(mediaQueryToken);\n                }\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (mediaQueryTokens_1_1 && !mediaQueryTokens_1_1.done && (_a = mediaQueryTokens_1.return)) _a.call(mediaQueryTokens_1);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n        if (nonNullMediaQueryTokens.length === 0) {\n            throw createError('No valid media queries');\n        }\n        return nonNullMediaQueryTokens;\n    }\n};\nexport var tokenizeMediaQuery = function (tokens) {\n    var firstToken = tokens[0];\n    if (firstToken.type === '<(-token>') {\n        try {\n            return {\n                mediaPrefix: null,\n                mediaType: 'all',\n                mediaCondition: tokenizeMediaCondition(tokens, true)\n            };\n        }\n        catch (err) {\n            throw createError(\"Expected media condition after '('\", err);\n        }\n    }\n    else if (firstToken.type === '<ident-token>') {\n        var mediaPrefix = null;\n        var mediaType = void 0;\n        var value = firstToken.value;\n        if (value === 'only' || value === 'not') {\n            mediaPrefix = value;\n        }\n        var firstIndex = mediaPrefix === null ? 0 : 1;\n        if (tokens.length <= firstIndex) {\n            throw createError(\"Expected extra token in media query\");\n        }\n        var firstNonUnaryToken = tokens[firstIndex];\n        if (firstNonUnaryToken.type === '<ident-token>') {\n            var value_1 = firstNonUnaryToken.value;\n            if (value_1 === 'all') {\n                mediaType = 'all';\n            }\n            else if (value_1 === 'print' || value_1 === 'screen') {\n                mediaType = value_1;\n            }\n            else if (value_1 === 'tty' ||\n                value_1 === 'tv' ||\n                value_1 === 'projection' ||\n                value_1 === 'handheld' ||\n                value_1 === 'braille' ||\n                value_1 === 'embossed' ||\n                value_1 === 'aural' ||\n                value_1 === 'speech') {\n                mediaPrefix = mediaPrefix === 'not' ? null : 'not';\n                mediaType = 'all';\n            }\n            else {\n                throw createError(\"Unknown ident '\".concat(value_1, \"' in media query\"));\n            }\n        }\n        else if (mediaPrefix === 'not' &&\n            firstNonUnaryToken.type === '<(-token>') {\n            var tokensWithParens = [\n                { type: '<(-token>', wsBefore: false, wsAfter: false }\n            ];\n            tokensWithParens.push.apply(tokensWithParens, tokens);\n            tokensWithParens.push({\n                type: '<)-token>',\n                wsBefore: false,\n                wsAfter: false\n            });\n            try {\n                return {\n                    mediaPrefix: null,\n                    mediaType: 'all',\n                    mediaCondition: tokenizeMediaCondition(tokensWithParens, true)\n                };\n            }\n            catch (err) {\n                throw createError(\"Expected media condition after '('\", err);\n            }\n        }\n        else {\n            throw createError('Invalid media query');\n        }\n        if (firstIndex + 1 === tokens.length) {\n            return {\n                mediaPrefix: mediaPrefix,\n                mediaType: mediaType,\n                mediaCondition: null\n            };\n        }\n        else if (firstIndex + 4 < tokens.length) {\n            var secondNonUnaryToken = tokens[firstIndex + 1];\n            if (secondNonUnaryToken.type === '<ident-token>' &&\n                secondNonUnaryToken.value === 'and') {\n                try {\n                    return {\n                        mediaPrefix: mediaPrefix,\n                        mediaType: mediaType,\n                        mediaCondition: tokenizeMediaCondition(tokens.slice(firstIndex + 2), false)\n                    };\n                }\n                catch (err) {\n                    throw createError(\"Expected media condition after 'and'\", err);\n                }\n            }\n            else {\n                throw createError(\"Expected 'and' after media prefix\");\n            }\n        }\n        else {\n            throw createError('Expected media condition after media prefix');\n        }\n    }\n    else {\n        throw createError('Expected media condition or media prefix');\n    }\n};\nexport var tokenizeMediaCondition = function (tokens, mayContainOr, previousOperator) {\n    if (previousOperator === void 0) { previousOperator = null; }\n    if (tokens.length < 3 ||\n        tokens[0].type !== '<(-token>' ||\n        tokens[tokens.length - 1].type !== '<)-token>') {\n        throw new Error('Invalid media condition');\n    }\n    var endIndexOfFirstFeature = tokens.length - 1;\n    var maxDepth = 0;\n    var count = 0;\n    for (var i = 0; i < tokens.length; i++) {\n        var token = tokens[i];\n        if (token.type === '<(-token>') {\n            count += 1;\n            maxDepth = Math.max(maxDepth, count);\n        }\n        else if (token.type === '<)-token>') {\n            count -= 1;\n        }\n        if (count === 0) {\n            endIndexOfFirstFeature = i;\n            break;\n        }\n    }\n    if (count !== 0) {\n        throw new Error('Mismatched parens\\nInvalid media condition');\n    }\n    var child;\n    var featureTokens = tokens.slice(0, endIndexOfFirstFeature + 1);\n    if (maxDepth === 1) {\n        child = tokenizeMediaFeature(featureTokens);\n    }\n    else {\n        if (featureTokens[1].type === '<ident-token>' &&\n            featureTokens[1].value === 'not') {\n            child = tokenizeMediaCondition(featureTokens.slice(2, -1), true, 'not');\n        }\n        else {\n            child = tokenizeMediaCondition(featureTokens.slice(1, -1), true);\n        }\n    }\n    if (endIndexOfFirstFeature === tokens.length - 1) {\n        return {\n            operator: previousOperator,\n            children: [child]\n        };\n    }\n    else {\n        var nextToken = tokens[endIndexOfFirstFeature + 1];\n        if (nextToken.type !== '<ident-token>') {\n            throw new Error('Invalid operator\\nInvalid media condition');\n        }\n        else if (previousOperator !== null &&\n            previousOperator !== nextToken.value) {\n            throw new Error(\"'\".concat(nextToken.value, \"' and '\").concat(previousOperator, \"' must not be at same level\\nInvalid media condition\"));\n        }\n        else if (nextToken.value === 'or' && !mayContainOr) {\n            throw new Error(\"Cannot use 'or' at top level of a media query\\nInvalid media condition\");\n        }\n        else if (nextToken.value !== 'and' && nextToken.value !== 'or') {\n            throw new Error(\"Invalid operator: '\".concat(nextToken.value, \"'\\nInvalid media condition\"));\n        }\n        var siblings = tokenizeMediaCondition(tokens.slice(endIndexOfFirstFeature + 2), mayContainOr, nextToken.value);\n        return {\n            operator: nextToken.value,\n            children: [child].concat(siblings.children)\n        };\n    }\n};\nexport var tokenizeMediaFeature = function (rawTokens) {\n    if (rawTokens.length < 3 ||\n        rawTokens[0].type !== '<(-token>' ||\n        rawTokens[rawTokens.length - 1].type !== '<)-token>') {\n        throw new Error('Invalid media feature');\n    }\n    var tokens = [rawTokens[0]];\n    for (var i = 1; i < rawTokens.length; i++) {\n        if (i < rawTokens.length - 2) {\n            var a = rawTokens[i];\n            var b = rawTokens[i + 1];\n            var c = rawTokens[i + 2];\n            if (a.type === '<number-token>' &&\n                a.value > 0 &&\n                b.type === '<delim-token>' &&\n                b.value === 0x002f &&\n                c.type === '<number-token>' &&\n                c.value > 0) {\n                tokens.push({\n                    type: '<ratio-token>',\n                    numerator: a.value,\n                    denominator: c.value,\n                    wsBefore: a.wsBefore,\n                    wsAfter: c.wsAfter\n                });\n                i += 2;\n                continue;\n            }\n        }\n        tokens.push(rawTokens[i]);\n    }\n    var nextToken = tokens[1];\n    if (nextToken.type === '<ident-token>' && tokens.length === 3) {\n        return {\n            context: 'boolean',\n            feature: nextToken.value\n        };\n    }\n    else if (tokens.length === 5 &&\n        tokens[1].type === '<ident-token>' &&\n        tokens[2].type === '<colon-token>') {\n        var valueToken = tokens[3];\n        if (valueToken.type === '<number-token>' ||\n            valueToken.type === '<dimension-token>' ||\n            valueToken.type === '<ratio-token>' ||\n            valueToken.type === '<ident-token>') {\n            var feature = tokens[1].value;\n            var prefix = null;\n            var slice = feature.slice(0, 4);\n            if (slice === 'min-') {\n                prefix = 'min';\n                feature = feature.slice(4);\n            }\n            else if (slice === 'max-') {\n                prefix = 'max';\n                feature = feature.slice(4);\n            }\n            var _0 = valueToken.wsBefore, _1 = valueToken.wsAfter, value = __rest(valueToken, [\"wsBefore\", \"wsAfter\"]);\n            return {\n                context: 'value',\n                prefix: prefix,\n                feature: feature,\n                value: value\n            };\n        }\n    }\n    else if (tokens.length >= 5) {\n        try {\n            var range = tokenizeRange(tokens);\n            return {\n                context: 'range',\n                feature: range.featureName,\n                range: range\n            };\n        }\n        catch (err) {\n            throw createError('Invalid media feature', err);\n        }\n    }\n    throw new Error('Invalid media feature');\n};\nexport var tokenizeRange = function (tokens) {\n    var _a, _b, _c, _d;\n    if (tokens.length < 5 ||\n        tokens[0].type !== '<(-token>' ||\n        tokens[tokens.length - 1].type !== '<)-token>') {\n        throw new Error('Invalid range');\n    }\n    var range = {\n        leftToken: null,\n        leftOp: null,\n        featureName: '',\n        rightOp: null,\n        rightToken: null\n    };\n    var hasLeft = tokens[1].type === '<number-token>' ||\n        tokens[1].type === '<dimension-token>' ||\n        tokens[1].type === '<ratio-token>' ||\n        (tokens[1].type === '<ident-token>' && tokens[1].value === 'infinite');\n    if (tokens[2].type === '<delim-token>') {\n        if (tokens[2].value === 0x003c) {\n            if (tokens[3].type === '<delim-token>' &&\n                tokens[3].value === 0x003d &&\n                !tokens[3].wsBefore) {\n                range[hasLeft ? 'leftOp' : 'rightOp'] = '<=';\n            }\n            else {\n                range[hasLeft ? 'leftOp' : 'rightOp'] = '<';\n            }\n        }\n        else if (tokens[2].value === 0x003e) {\n            if (tokens[3].type === '<delim-token>' &&\n                tokens[3].value === 0x003d &&\n                !tokens[3].wsBefore) {\n                range[hasLeft ? 'leftOp' : 'rightOp'] = '>=';\n            }\n            else {\n                range[hasLeft ? 'leftOp' : 'rightOp'] = '>';\n            }\n        }\n        else if (tokens[2].value === 0x003d) {\n            range[hasLeft ? 'leftOp' : 'rightOp'] = '=';\n        }\n        else {\n            throw new Error('Invalid range');\n        }\n        if (hasLeft) {\n            range.leftToken = tokens[1];\n        }\n        else if (tokens[1].type === '<ident-token>') {\n            range.featureName = tokens[1].value;\n        }\n        else {\n            throw new Error('Invalid range');\n        }\n        var tokenIndexAfterFirstOp = 2 + ((_b = (_a = range[hasLeft ? 'leftOp' : 'rightOp']) === null || _a === void 0 ? void 0 : _a.length) !== null && _b !== void 0 ? _b : 0);\n        var tokenAfterFirstOp = tokens[tokenIndexAfterFirstOp];\n        if (hasLeft) {\n            if (tokenAfterFirstOp.type === '<ident-token>') {\n                range.featureName = tokenAfterFirstOp.value;\n                if (tokens.length >= 7) {\n                    var secondOpToken = tokens[tokenIndexAfterFirstOp + 1];\n                    var followingToken = tokens[tokenIndexAfterFirstOp + 2];\n                    if (secondOpToken.type === '<delim-token>') {\n                        var charCode = secondOpToken.value;\n                        if (charCode === 0x003c) {\n                            if (followingToken.type === '<delim-token>' &&\n                                followingToken.value === 0x003d &&\n                                !followingToken.wsBefore) {\n                                range.rightOp = '<=';\n                            }\n                            else {\n                                range.rightOp = '<';\n                            }\n                        }\n                        else if (charCode === 0x003e) {\n                            if (followingToken.type === '<delim-token>' &&\n                                followingToken.value === 0x003d &&\n                                !followingToken.wsBefore) {\n                                range.rightOp = '>=';\n                            }\n                            else {\n                                range.rightOp = '>';\n                            }\n                        }\n                        else {\n                            throw new Error('Invalid range');\n                        }\n                        var tokenAfterSecondOp = tokens[tokenIndexAfterFirstOp + 1 + ((_d = (_c = range.rightOp) === null || _c === void 0 ? void 0 : _c.length) !== null && _d !== void 0 ? _d : 0)];\n                        range.rightToken = tokenAfterSecondOp;\n                    }\n                    else {\n                        throw new Error('Invalid range');\n                    }\n                }\n                else if (tokenIndexAfterFirstOp + 2 !== tokens.length) {\n                    throw new Error('Invalid range');\n                }\n            }\n            else {\n                throw new Error('Invalid range');\n            }\n        }\n        else {\n            range.rightToken = tokenAfterFirstOp;\n        }\n        var validRange = null;\n        var lt = range.leftToken, leftOp = range.leftOp, featureName = range.featureName, rightOp = range.rightOp, rt = range.rightToken;\n        var leftToken = null;\n        if (lt !== null) {\n            if (lt.type === '<ident-token>') {\n                var type = lt.type, value = lt.value;\n                if (value === 'infinite') {\n                    leftToken = { type: type, value: value };\n                }\n            }\n            else if (lt.type === '<number-token>' ||\n                lt.type === '<dimension-token>' ||\n                lt.type === '<ratio-token>') {\n                var _0 = lt.wsBefore, _1 = lt.wsAfter, ltNoWS = __rest(lt, [\"wsBefore\", \"wsAfter\"]);\n                leftToken = ltNoWS;\n            }\n        }\n        var rightToken = null;\n        if (rt !== null) {\n            if (rt.type === '<ident-token>') {\n                var type = rt.type, value = rt.value;\n                if (value === 'infinite') {\n                    rightToken = { type: type, value: value };\n                }\n            }\n            else if (rt.type === '<number-token>' ||\n                rt.type === '<dimension-token>' ||\n                rt.type === '<ratio-token>') {\n                var _0 = rt.wsBefore, _1 = rt.wsAfter, rtNoWS = __rest(rt, [\"wsBefore\", \"wsAfter\"]);\n                rightToken = rtNoWS;\n            }\n        }\n        if (leftToken !== null && rightToken !== null) {\n            if ((leftOp === '<' || leftOp === '<=') &&\n                (rightOp === '<' || rightOp === '<=')) {\n                validRange = { leftToken: leftToken, leftOp: leftOp, featureName: featureName, rightOp: rightOp, rightToken: rightToken };\n            }\n            else if ((leftOp === '>' || leftOp === '>=') &&\n                (rightOp === '>' || rightOp === '>=')) {\n                validRange = { leftToken: leftToken, leftOp: leftOp, featureName: featureName, rightOp: rightOp, rightToken: rightToken };\n            }\n            else {\n                throw new Error('Invalid range');\n            }\n        }\n        else if (leftToken === null &&\n            leftOp === null &&\n            rightOp !== null &&\n            rightToken !== null) {\n            validRange = { leftToken: leftToken, leftOp: leftOp, featureName: featureName, rightOp: rightOp, rightToken: rightToken };\n        }\n        else if (leftToken !== null &&\n            leftOp !== null &&\n            rightOp === null &&\n            rightToken === null) {\n            validRange = { leftToken: leftToken, leftOp: leftOp, featureName: featureName, rightOp: rightOp, rightToken: rightToken };\n        }\n        return validRange;\n    }\n    else {\n        throw new Error('Invalid range');\n    }\n};\n//# sourceMappingURL=syntacticAnalysis.js.map"],"names":["weirdNewlines","nullOrSurrogates","commentRegex","lexicalAnalysis","str","index","replace","tokens","length","code","charCodeAt","code_1","push","type","result","consumeString","lastIndex","value","nextCode","flag","wouldStartIdentifier","consumeIdentUnsafe","toLowerCase","plusNumeric","consumeNumeric","tokenTuple","unit","minusNumeric","nextNextCode","consumeIdentLike","nextNextNextCode","consumeIdent","consumeEscape","slice","firstCode","charCodes","i","String","fromCharCode","apply","charCode","hexCharCodes","min","Math","code_2","code_3","parseInt","numberResult","consumeNumber","numberEndIndex","numberValue","numberFlag","identResult","identEndIndex","identValue","numberChars","nextNextIsDigit","numberString","parseFloat","Number","isNaN","identChars","code_4","code_5","consumeUrl","urlChars","hasFinishedWord","offset","result_1","lastUrlIndex","value_1","simplifyAST","ast","simplifyMediaQuery","mediaQuery","mediaCondition","simplifyMediaCondition","operator","children","mediaPrefix","mediaType","unsimplifiedChild","child","spliceArgs","i_1","splice","createError","message","err","Error","trim","concat","toAST","toUnflattenedAST","tokenList","startIndex","endIndex","token","syntacticAnalysis","removeWhitespace","newTokenList","before","wsAfter","__assign","wsBefore","mediaQueryList","mediaQueries","map","mediaQueryTokens","tokenizeMediaQuery","nonNullMediaQueryTokens","mediaQueryTokens_1_1","mediaQueryToken","firstToken","tokenizeMediaCondition","firstIndex","firstNonUnaryToken","tokensWithParens","secondNonUnaryToken","mayContainOr","previousOperator","endIndexOfFirstFeature","maxDepth","count","max","featureTokens","tokenizeMediaFeature","nextToken","siblings","rawTokens","a","b","c","numerator","denominator","context","feature","valueToken","prefix","range","tokenizeRange","featureName","leftToken","leftOp","rightOp","rightToken","hasLeft","tokenIndexAfterFirstOp","_a","_b","tokenAfterFirstOp","secondOpToken","followingToken","tokenAfterSecondOp","_c","_d","validRange","lt","rt","ltNoWS","rtNoWS"],"mappings":"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"}